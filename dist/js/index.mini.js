"use strict";const $form=document.querySelector("#form"),$saveButton=document.getElementById("button-save"),$resetButton=document.getElementById("button-reset"),$checkbox=document.getElementById("describing-checkbox"),$internalTextbox=document.getElementById("internal_use_textarea"),$externalTextbox=document.getElementById("external_use_textarea"),alertOnLoad=document.querySelector(".alert"),$formInputs=document.querySelectorAll(".form__input"),$groupName=document.getElementById("group-name"),$alias=document.getElementById("alias"),$email=document.getElementById("mail"),$phone=document.getElementById("phone"),inputsArrray=Array.from($formInputs);function setText(e){switch(e.id){case"phone":e.nextElementSibling.innerText="Введите корректный номер";break;case"mail":e.nextElementSibling.innerText="Введите корректный адрес";break;case"alias":e.nextElementSibling.innerText="Алиас не может содержать русские буквы и пробелы";break;default:e.nextElementSibling.innerText=""}}function textAreaLabelColor(e){e.value?e.parentElement.classList.add("form__labeled-textarea_filled"):e.parentElement.classList.remove("form__labeled-textarea_filled"),e.addEventListener("focus",function(){this.parentElement.classList.add("form__labeled-textarea_focused")}),e.addEventListener("blur",function(){this.parentElement.classList.remove("form__labeled-textarea_focused"),this.value?this.parentElement.classList.add("form__labeled-textarea_filled"):this.parentElement.classList.remove("form__labeled-textarea_filled")})}function setTextareaBorder(){textAreaLabelColor($externalTextbox),textAreaLabelColor($internalTextbox)}function setTextareaBackground(){$internalTextbox.value.length?$internalTextbox.classList.add("form__textarea_lined-bg"):$internalTextbox.classList.remove("form__textarea_lined-bg"),$externalTextbox.value.length?$externalTextbox.classList.add("form__textarea_lined-bg"):$externalTextbox.classList.remove("form__textarea_lined-bg")}function setSaveButtonStatus(){inputsArrray.some(e=>e.value.length>0)||$externalTextbox.value.length>0?$saveButton.disabled=!1:$saveButton.disabled=!0}function checkForErrors(e){e.validity.valid||""==e.value?(e.parentElement.classList.remove("form__labeled-item_invalid"),e.nextElementSibling.classList.remove("form__error_animated"),e.parentElement.classList.remove("form__labeled-item_filled"),e.nextElementSibling.innerText=""):(e.parentElement.classList.add("form__labeled-item_invalid"),e.nextElementSibling.classList.add("form__error_animated"),setText(e)),(e.validity.valid||e.value)&&e.parentElement.classList.add("form__labeled-item_filled")}$externalTextbox.addEventListener("input",function(){setTextareaBackground(),setSaveButtonStatus()}),inputsArrray.forEach(e=>{e.addEventListener("focus",function(){this.parentElement.classList.add("form__labeled-item_focused")}),e.addEventListener("blur",function(){this.parentElement.classList.remove("form__labeled-item_focused")}),e.addEventListener("input",function(){checkForErrors(e),e.value?e.classList.add("form__input_border-bottom"):e.classList.remove("form__input_border-bottom"),setSaveButtonStatus()})}),$checkbox.addEventListener("change",function(){const e=$internalTextbox.value;this.checked?($externalTextbox.value="",$externalTextbox.disabled=!1):($externalTextbox.value=e,$externalTextbox.disabled=!0),setSaveButtonStatus(),setTextareaBackground(),textAreaLabelColor($externalTextbox)}),$form.addEventListener("submit",function(e){inputsArrray.forEach(e=>{e.validity.valueMissing?(e.parentElement.classList.add("form__labeled-item_invalid"),e.nextElementSibling.classList.add("form__error_animated"),e.nextElementSibling.innerText="Нужно заполнить поле"):e.validity.valid?(e.parentElement.classList.remove("form__labeled-item_invalid"),e.nextElementSibling.classList.remove("form__error_animated"),e.nextElementSibling.innerText=""):(e.parentElement.classList.add("form__labeled-item_invalid"),e.nextElementSibling.classList.add("form__error_animated"),setText(e))}),inputsArrray.every(e=>e.validity.valid)&&alertOnLoad.classList.contains("alert_showed-up")&&(alertOnLoad.classList.remove("alert_showed-up"),alertOnLoad.classList.add("alert_showed-down"),setTimeout(()=>{alert("Отправлено на модерацию")},1100)),e.preventDefault()}),$saveButton.addEventListener("click",function(){inputsArrray.forEach(e=>{sessionStorage.setItem(`${e.id}`,`${e.value}`)});const e=$externalTextbox.value;sessionStorage.setItem("public-text",e),alert("Данные успешно сохранены")}),$resetButton.addEventListener("mousedown",function(){inputsArrray.forEach(e=>{e.classList.remove("form__input_border-bottom"),e.parentElement.classList.remove("form__labeled-item_invalid"),e.nextElementSibling.classList.remove("form__error_animated"),e.parentElement.classList.remove("form__labeled-item_filled")}),$externalTextbox.parentElement.classList.remove("form__labeled-textarea_filled"),$saveButton.disabled=!0,$externalTextbox.value="",$externalTextbox.disabled=!1,setTextareaBackground()}),document.addEventListener("DOMContentLoaded",function(){!async function(){const e=e=>new Promise(t=>setTimeout(()=>t(),e));Object.values(sessionStorage).some(e=>e)?(inputsArrray.forEach(async t=>{t.value=sessionStorage[`${t.id}`],t.value?t.classList.add("form__input_border-bottom"):t.classList.remove("form__input_border-bottom"),await e(700),checkForErrors(t)}),await e(500),alertOnLoad.classList.remove("alert_showed-down"),alertOnLoad.classList.add("alert_showed-up")):inputsArrray.forEach(e=>e.value="")}();const e=sessionStorage.getItem("public-text");e&&e.length?$externalTextbox.value=e:$externalTextbox.value="",setTextareaBorder(),setSaveButtonStatus(),setTextareaBackground()}),$phone.setAttribute("maxlength","18"),$phone.addEventListener("focus",function(e){e.target.value.length<4&&(this.value="+7 (")}),$phone.addEventListener("input",function(e){e.target.value.length<4&&(this.value="+7 (")}),$phone.addEventListener("keydown",function(e){let t=this.value;event.which>=48&&event.which<=57||event.which>=96&&event.which<=105?(t=this.value,(event.which>=48&&event.which<=57||event.which>=96&&event.which<=105)&&(7===t.length&&(e.target.value=`${t}) `),8===t.length&&(e.target.value=`${t} `),12===t.length&&(e.target.value=`${t}-`),15===t.length&&(e.target.value=`${t}-`))):8===event.which?t=this.value:event.which>=32&&event.which<=40?e.preventDefault():event.which>64&&event.which<=90&&e.preventDefault()});